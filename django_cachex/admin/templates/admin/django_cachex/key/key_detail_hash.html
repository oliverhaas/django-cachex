{% load i18n %}
<!-- Hash Operations -->
<fieldset class="module aligned">
    <h2>{% trans 'Operations' %}</h2>
    <div class="form-row">
        <label>{% trans 'Set Field:' %}</label>
        <form method="post" style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="action" value="hset">
            <input type="text" name="field_name" placeholder="{% trans 'field' %}" style="width: 100px;">
            <input type="text" name="field_value" placeholder="{% trans 'value' %}" style="width: 150px;">
            <button type="submit" class="button btn-small">{% trans 'Set' %}</button>
        </form>
    </div>
</fieldset>
<!-- Hash Fields -->
<fieldset class="module aligned">
    <h2>{% trans 'Hash Fields' %}{% if type_data.length %} ({{ type_data.length }}){% endif %}</h2>
    {% if type_data.fields %}
    <div class="results">
        <table id="result_list" style="width: 100%;">
            <thead>
                <tr>
                    <th scope="col">{% trans 'Field' %}</th>
                    <th scope="col">{% trans 'Value' %}</th>
                    <th scope="col" style="width: 150px;">{% trans 'Actions' %}</th>
                </tr>
            </thead>
            <tbody>
                {% for field, value in type_data.fields.items %}
                <tr class="{% cycle 'row1' 'row2' %}">
                    <td><code>{{ field }}</code></td>
                    <td>
                        <input type="text" name="field_value" value="{{ value }}" class="vTextField" form="hash-update-{{ forloop.counter0 }}" style="width: 100%; box-sizing: border-box;">
                    </td>
                    <td>
                        <button type="submit" form="hash-update-{{ forloop.counter0 }}" class="button btn-small">{% trans 'Update' %}</button>
                        <button type="submit" form="hash-delete-{{ forloop.counter0 }}" class="button delete-btn btn-small">{% trans 'Delete' %}</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <!-- Forms for hash operations (outside table for valid HTML) -->
    {% for field, value in type_data.fields.items %}
    <form id="hash-update-{{ forloop.counter0 }}" method="post" style="display: none;">
        {% csrf_token %}
        <input type="hidden" name="action" value="hset">
        <input type="hidden" name="field_name" value="{{ field }}">
    </form>
    <form id="hash-delete-{{ forloop.counter0 }}" method="post" style="display: none;">
        {% csrf_token %}
        <input type="hidden" name="action" value="hdel">
        <input type="hidden" name="field" value="{{ field }}">
    </form>
    {% endfor %}
    {% else %}
    <p class="quiet" style="padding: 10px;">{% trans 'Hash is empty.' %}</p>
    {% endif %}
</fieldset>
